const MongoClient = require('mongodb').MongoClient;
const assert = require('assert');
const http = require('http');
const url = require('url');
 
const mongourl = 'mongodb+srv://Qiuyingci:Qyc052714@cluster0.jvmayzu.mongodb.net/?retryWrites=true&w=majority';
const dbName = 'test';
const client = new MongoClient(mongourl);
 
const criteria = {"studentId": "d"};


const findDocument = (db, criteria, callback) => {
    let cursor = db.collection('bookings').find(criteria);
    cursor.toArray((err,docs) => {
        assert.equal(null,err);
        callback(docs);
    })
}

client.connect((err) => {
    assert.equal(null, err);
    console.log("Connected successfully to server");
    const db = client.db(dbName);
    findDocument(db, criteria, (docs) => {
        client.close();
        console.log("Closed DB connection");
        for (doc of docs) {
            console.log(doc);
        }
    })
});
server.listen(process.env.PORT || 8099);
